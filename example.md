- BIM (Building Information Modeling)
    - [ POWERBIM GROUPS in POWERBIM on Vimeo](https://vimeo.com/channels/powerbim/364000925)  
    - Resources
        - [ Express 4D Simulation Scheduling and Construction Management with Dynamo | Autodesk University](https://www.autodesk.com/autodesk-university/class/Express-4D-Simulation-Scheduling-and-Construction-Management-Dynamo-2020#video)  
        - [ cmBuilder - Dynamic Construction Planning & Simulation Software](https://www.cmbuilder.io/)  
    - Laser Scan
        - [ Laan Labs - Live laser scanning - Twitter](https://twitter.com/laanlabs/status/1313509591448268801?s=09)  
    - Autodesk Forge
        - [[Aliases]]
            - Forge
        - Forge API's
            - [ APIs | Autodesk Forge](https://forge.autodesk.com/en/docs/)
            - [ Forge APIs - Create an App | Autodesk Forge](https://forge.autodesk.com/en/docs/oauth/v2/tutorials/create-app/)
            - [ Design Automation APIs | Autodesk Forge](https://forge.autodesk.com/en/docs/design-automation/v3/tutorials/revit/)
                - [ Revit Data on Forge - How Can the Design Automation for Revit API Help Me? | Autodesk University](https://www.autodesk.com/autodesk-university/class/Revit-Data-Forge-How-Can-Design-Automation-Revit-API-Help-Me-2018)
                - [ Design Automation API for Revit on Forge - YouTube](https://www.youtube.com/watch?v=PkdBM0cFrN4)
                - Autodesk University
                    - [ AU 2017 - The New and Expanded Forge Design Automation API | Autodesk University](https://www.autodesk.com/autodesk-university/class/New-and-Expanded-Forge-Design-Automation-API-2017)  
                    - [ AU 2018 - Manage Revit Digital Content using Forge Design Automation API for Revit. | Autodesk University](https://www.autodesk.com/autodesk-university/class/Manage-Revit-Digital-Content-using-Forge-Design-Automation-API-Revit-2018)  
                    - [ AU 2019 - Getting Started on Design Automation for Revit on Forge | Autodesk University](https://www.autodesk.com/autodesk-university/class/Getting-Started-Design-Automation-Revit-Forge-2019)  
                    - [ AU 2019 - Automation Workflows with the Forge Design Automation API for Revit | Autodesk University](https://www.autodesk.com/autodesk-university/class/Automation-Workflows-Forge-Design-Automation-API-Revit-2019)  
                    - [ AU 2019 - Learning Lab: Modify files using Design Automation API | Autodesk University](https://www.autodesk.com/autodesk-university/class/Learning-Lab-Modify-files-using-Design-Automation-API-2019)  
                    - [ AU 2020 - Design Automation for Revit: Basics and beyond | Autodesk University](https://www.autodesk.com/autodesk-university/es/class/Design-Automation-Revit-Beyond-Basics-2020#video)
                    - [ AU 2020 - Using Design Automation for Revit for Displaying RFAs in the Forge Viewer | Autodesk University](https://www.autodesk.com/autodesk-university/class/Using-Design-Automation-Revit-Displaying-RFAs-Forge-Viewer-2020)  
                    - [ AU 2020 - Forge and Generative Design for Planning, Modeling, and Fabrication | Autodesk University](https://www.autodesk.com/autodesk-university/class/Forge-and-Generative-Design-Planning-Modeling-and-Fabrication-2019)  
                    - [ Serverless, Rules-Based Design Automation with Forge and Azure | Autodesk University](https://www.autodesk.com/autodesk-university/class/Serverless-Rules-Based-Design-Automation-Forge-and-Azure-2020#video)  
            - [ Autodesk Forge - Getting Started](https://forge.autodesk.com/developer/getting-started)
            - [ Autodesk Forge - Online Viewer App](https://forge.autodesk.com/developer/learn/viewer-app/overview)
            - Forge Model Derivative Service
                - [ Forge Model Derivative API Sample](https://derivatives.autodesk.io/)
                - [ Lmv Ninja](http://lmv.ninja.autodesk.com/)
                - [ Deep Dive with the Model Derivative API | Autodesk University](https://www.autodesk.com/autodesk-university/class/Deep-Dive-Model-Derivative-API-2017#video)
                    - [ GitHub - Autodesk-Forge/forge-derivatives-explorer: Autodesk design file explorer: Shows how to use the Forge APIs from Node.js - focusing on Model Derivative API](https://github.com/Autodesk-Forge/forge-derivatives-explorer)
                    - [ Forge Model Derivative API Sample](https://derivatives.autodesk.io/)
                    - [ Lmv Ninja](http://lmv.ninja.autodesk.com/)
                - [Translate a Revit File, Generating Room and Space Information | Model Derivative API   | Autodesk Forge](https://forge.autodesk.com/en/docs/model-derivative/v2/tutorials/prep-roominfo4viewer/)
            - [ Forge Platform Learning Content - YouTube](https://www.youtube.com/playlist?list=PL_6ApchKwjN9CZCqUl4RZrsyDvnTV1Jgb)
            - [ What the Heck Is Forge? | Autodesk University](https://www.autodesk.com/autodesk-university/class/What-Heck-Forge-2017)
            - [ Demystifying the BIM 360 and Forge APIs | Autodesk University](https://www.autodesk.com/autodesk-university/class/Demystifying-BIM-360-and-Forge-APIs-2017)
            - [More Tips, Tricks, and the Future of the Forge Model Derivative Service | Autodesk University](https://www.autodesk.com/autodesk-university/class/More-Tips-Tricks-and-Future-Forge-Model-Derivative-Service-2020)
                - Change Management with Forge (14:30)
                    - Identify changes in model using Design Automation
                - [ Explore how to use your model derivative data to do model version comparison with @AutodeskForge  ](https://twitter.com/autodesku/status/1351593287883358208)
                - Generate Room geometry for a Revit Model (24:15) using forge "`generateMasterViews`"
                - [ New RVT->SVF Model Derivative parameter generates additional content, including rooms and spaces. | Autodesk Forge](https://forge.autodesk.com/blog/new-rvt-svf-model-derivative-parameter-generates-additional-content-including-rooms-and-spaces)
            - [ Advanced Techniques for Using the Forge Viewer | Autodesk University](https://www.autodesk.com/autodesk-university/class/Advanced-Techniques-Using-Forge-Viewer-2018#presentation) #Three.js #WebGL
                - Use Three.js #WebGL to add physics to models
                - Use Shaders to add custom textures on elements
                - Use anime.js or Tween.js to add animation to model elements - 1:10:20
                - [ GitHub - apprentice3d/SD226781-Samples: Forge Viewer samples illustrated during AU class  SD226781](https://github.com/apprentice3d/SD226781-Samples)
                - [ SD226781_BasicViewer](https://apprentice3d.github.io/SD226781-Samples/)
            - Resources
                - Use `NOP_VIEWER.getAllModels()` to extract all model metadata
                - [ Do simple Viewer API tests quickly | Autodesk Forge](https://forge.autodesk.com/blog/do-simple-viewer-api-tests-quickly)
                - [ Forge Lightning Talks: Loading multi-models in Forge Viewer - YouTube](https://www.youtube.com/watch?v=nC-vBuyFMD4)
                    - [Loading Multiple Models in Forge Viewer v7 | Autodesk Forge](https://forge.autodesk.com/blog/loading-multiple-models-forge-viewer-v7)
                    - Load multiple model using Forge
                    - Align multiple models
                    - Hypermodeling - Loading a 3D model on top a 2D sheet with sections
                - [ Adding 3D geometry to a scene in the Forge viewer - Through the Interface](https://www.keanw.com/2018/08/adding-3d-geometry-to-a-scene-in-the-forge-viewer.html)
                - [ Custom geometry in Forge Viewer | Autodesk Forge](https://forge.autodesk.com/blog/custom-models-forge-viewer)
                    - Adding Threejs geometry or custom geometry in Forge Viewer
                    - [ javascript - Forge Viewer - How to access (or get render/fragment proxy of) cloned Meshes in scene? - Stack Overflow](https://stackoverflow.com/questions/63918310/forge-viewer-how-to-access-or-get-render-fragment-proxy-of-cloned-meshes-in)
                    - [ Scene Builder -  Add Custom Geometry - APIs | Autodesk Forge](https://forge.autodesk.com/en/docs/viewer/v7/developers_guide/advanced_options/scene-builder/)
                    - [ Overlay Manager - Add Custom Geometry - APIs | Autodesk Forge](https://forge.autodesk.com/en/docs/viewer/v7/developers_guide/advanced_options/custom-geometry/)
                - Code Examples:
                    - Change color of selection
                        - ```javascript
NOP_VIEWER.setSelectionColor(new THREE.Color(0xFF0000), Autodesk.Viewing.SelectionMode.MIXED);```
                    - Get properties of selected element
                        - ```javascript
NOP_VIEWER.getProperties(NOP_VIEWER.getSelection(), data => console.log(data))```
                        - [ Get dbId from externalId | Autodesk Forge](https://forge.autodesk.com/blog/get-dbid-externalid)
                        - ```javascript
NOP_VIEWER.getProperties(NOP_VIEWER.getSelection(), data => selected_dbId = data.dbId)```
                        - 
                    - Add a Turntable button to the Forge Viewer toolbar at the bottom
                        - [ Add Toolbar Button - APIs | Autodesk Forge](https://forge.autodesk.com/en/docs/viewer/v6/tutorials/toolbar-button/)
                            - ```javascript
  var viewer = NOP_VIEWER;
  // Button 1

var turnTableToolbarButton = new Autodesk.Viewing.UI.Button('turnTableButton');
 
 let started = false;

  let rotateCamera = () => {
      if (started) {
          requestAnimationFrame(rotateCamera);
      }

      const nav = NOP_VIEWER.navigation;
      const up = nav.getCameraUpVector();
      const axis = new THREE.Vector3(0, 0, 1);
      const speed = 10.0 * Math.PI / 180;
      const matrix = new THREE.Matrix4().makeRotationAxis(axis, speed * 0.1);

      let pos = nav.getPosition();
      pos.applyMatrix4(matrix);
      up.applyMatrix4(matrix);
      nav.setView(pos, new THREE.Vector3(0, 0, 0));
      nav.setCameraUpVector(up);
      var viewState = viewer.getState();
      // viewer.restoreState(viewState);
  };

  turnTableToolbarButton.onClick = function (e) {
      started = !started;
      if (started) rotateCamera()
  };

  var button1 = new Autodesk.Viewing.UI.Button('my-view-front-button');
  button1.onClick = function(e) {
      viewer.setViewCube('front');
  };
  button1.addClass('my-view-front-button');
  button1.setToolTip('View front');


  // SubToolbar
  this.subToolbar = new Autodesk.Viewing.UI.ControlGroup('my-custom-view-toolbar');
  this.subToolbar.addControl(turnTableToolbarButton);

  viewer.toolbar.addControl(this.subToolbar);```
                    - Transform elements in Forge Viewer using THREE matrix
                        - Change the scale, position and rotation of an element
                        - [ Get THREE.Mesh elements in Autodesk Forge Viewer - Stack Overflow](https://stackoverflow.com/questions/41232207/get-three-mesh-elements-in-autodesk-forge-viewer/41233527#41233527)
                            - You get the fragment Ids for a given dbId either from the selection event, as illustrated in the above samples, or by using enumNodeFragments:
                            - ```javascript
 var instanceTree = model.getData().instanceTree

 var fragIds = []

 instanceTree.enumNodeFragments(dbId, function(fragId){
     fragIds.push(fragId)
 })

 // to change material or transform, need to iterate all
 // fragments of a given dbId and apply same material/transform

 fragIds.forEach(function(fragId) {

     var renderProxy = viewer.impl.getRenderProxy(viewer.model, fragId)

     var fragmentproxy = viewer.impl.getFragmentProxy(viewer.model, fragId)
 })```
                            - [ Moving visually your components in the viewer using the TransformTool](https://adndevblog.typepad.com/cloud_and_mobile/2015/08/moving-visually-your-components-in-the-viewer-using-the-transformtool.html)
                        - [ Working with 2D and 3D Scenes and Geometry in Forge Viewer | Autodesk Forge](https://forge.autodesk.com/blog/working-2d-and-3d-scenes-and-geometry-forge-viewer)
                            - change scale of selected element
                                - ```javascript
// declare scaleCoef only one time
//let scaleCoef = 1

var tree = NOP_VIEWER.model.getInstanceTree();
    var frags = NOP_VIEWER.model.getFragmentList();
    function modifyFragmentTransform(fragId) {
      let scale = new THREE.Vector3();
      let rotation = new THREE.Quaternion();
      let translation = new THREE.Vector3();
      frags.getAnimTransform(fragId, scale, rotation, translation);
//       switch (ev.target.id) {
//         case 'increase':
          //translation.z += 10.0;
          scaleCoef -= 0.1;
//           break;
//         case 'decrease':
//           //translation.z -= 10.0;
//           scaleCoef -= 0.1;
//           break;
//       }
      	scale.x = scale.y = scale.z = scaleCoef;
//		rotation.x = rotation.y = rotation.z = scaleCoef;
//		translation.x = translation.y = translation.z = scaleCoef;

      frags.updateAnimTransform(fragId, scale, rotation, translation);
    }
    if (tree) { // Could be null if the tree hasn't been loaded yet
      var selectedIds = NOP_VIEWER.getSelection();
      for (var dbId of selectedIds) {
        var fragIds = [];
        tree.enumNodeFragments(dbId, modifyFragmentTransform, false);
      }
      NOP_VIEWER.impl.invalidate(true, true, true);
    }```
                        - 
                        - Load Transformation Extension
                            - [ forge-extensions/public/extensions/TransformationExtension at master · Autodesk-Forge/forge-extensions · GitHub](https://github.com/Autodesk-Forge/forge-extensions/tree/master/public/extensions/TransformationExtension)
                            - ```javascript
// Not working right now

var script = document.createElement('script');
script.type = 'text/javascript';
script.src = 'http://cdn.jsdelivr.net/gh/autodesk-forge/forge-extensions/public/extensions/transform/contents/main.js';
document.head.appendChild(script)

// wait for 2 secs (2000ms) the above script to be loaded
setTimeout(() => NOP_VIEWER.loadExtension('TransformationExtension'), 2000);```
                    - Get FragIds of selected element
                        - ```javascript
var instanceTree = NOP_VIEWER.model.getData().instanceTree

 var fragIds = []
var selected_dbId
NOP_VIEWER.getProperties(NOP_VIEWER.getSelection(), data => selected_dbId = data.dbId)

 instanceTree.enumNodeFragments(selected_dbId[0], function(fragId){
     fragIds.push(fragId)
 })
console.log(fragIds)```
                        - 
                    - [ Custom geometry in Forge Viewer | Autodesk Forge](https://forge.autodesk.com/blog/custom-models-forge-viewer)
                        - Add the `SceneBuilder` Extension and add geometry using `addNewModel`
                            - This allows you to select the custom geometry
                            - ```javascript
async function addModel(viewer) {
const sceneBuilder =  await viewer.loadExtension('Autodesk.Viewing.SceneBuilder');
const modelBuilder = await sceneBuilder.addNewModel({
  modelNameOverride: 'My Custom Model',
  conserveMemory: false
});
const sphereGeometry = new THREE.BufferGeometry().fromGeometry(new THREE.SphereGeometry(500, 80, 80));
const sphereMaterial = new THREE.MeshPhongMaterial({ color: new THREE.Color(0, 1, 0) });
const sphereTransform = new THREE.Matrix4().compose(
new THREE.Vector3(0, 0, 0),
new THREE.Quaternion(0, 0, 0, 1),
new THREE.Vector3(1, 1, 1)
);
const sphereFragId = modelBuilder.addFragment(sphereGeometry, sphereMaterial, sphereTransform);
modelBuilder.changeFragmentsDbId(sphereFragId, 12345); // Use this dbId in Viewer APIs as usual
}
// Call the above function
addModel(NOP_VIEWER)```
                        - Add a `custom scene` and add geometry in the scene
                            - This DOES NOT allow us to select the custom geometry
                            - ```javascript
var geom = new THREE.SphereGeometry(100, 8, 8);
var material = new THREE.MeshBasicMaterial({ color: 0xff0000 });
var sphereMesh = new THREE.Mesh(geom, material);
sphereMesh.position.set(1, 2, 3);

if (!NOP_VIEWER.overlays.hasScene('custom-scene')) {
    NOP_VIEWER.overlays.addScene('custom-scene');
}

NOP_VIEWER.overlays.addMesh(sphereMesh, 'custom-scene');```
                    - Load & Unload Built-in Extensions
                        - [ Extensions - APIs | Autodesk Forge](https://forge.autodesk.com/en/docs/viewer/v7/reference/Extensions/)
                        - Cluster or Group elements in Forge based on Category
                            - ```javascript
NOP_VIEWER.loadExtension('Autodesk.VisualClusters')```
                            - ```javascript
NOP_VIEWER.unloadExtension('Autodesk.VisualClusters')```
                            - Note: this does not **always** work in BIM 360 Viewer - Try using a Custom Forge Viewer like - [ Forge Extensions](https://forge-extensions.autodesk.io/) or for vCon - [ DPR BIM QTO](https://dprbimqtodev.azurewebsites.net/)
                                - [This is for custom Viewer only...](https://twitter.com/augustomaia/status/1214933482125877248)
                                - 
                        - Forge Extensions CDN location: [ autodesk-forge/forge-extensions CDN by jsDelivr - A free, fast, and reliable Open Source CDN](https://cdn.jsdelivr.net/gh/autodesk-forge/forge-extensions/public/extensions/)
                            - Another way to load Extension (using jsDeliver cdn)
                                - ```javascript
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = 'https://cdn.jsdelivr.net/gh/autodesk-forge/forge-extensions@master/public/extensions/CameraRotation/contents/main.js';
document.head.appendChild(script)

// wait for 2 secs (2000ms) the above script to be loaded
setTimeout(() => NOP_VIEWER.loadExtension('CameraRotation'), 2000);```
                                - 
                                - ```javascript
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = 'https://cdn.jsdelivr.net/gh/autodesk-forge/forge-extensions/public/extensions/NestedViewerExtension/contents/main.js';
document.head.appendChild(script)
setTimeout(() => NOP_VIEWER.loadExtension("NestedViewerExtension", { filter: ["2d", "3d"], crossSelection: true }), 2000);```
                                - 
                                - ```javascript
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = 'https://cdn.jsdelivr.net/gh/Autodesk-Forge/forge-extensions/public/extensions/TransformationExtension/contents/main.js';
document.head.appendChild(script)
setTimeout(() => NOP_VIEWER.loadExtension("TransformationExtension"), 2000); ```
                                - 
                                - Transformation Explorer (rarely working) - [ ForgeViewerExtensions/transformationExplorer.js at master · apprentice3d/ForgeViewerExtensions · GitHub](https://github.com/apprentice3d/ForgeViewerExtensions/blob/master/assets/js/extensions/transformationExplorer.js)
                                - Working Example: [ Transformation Explorer - Forge-Extensions-Example](https://apprentice3d.github.io/ForgeViewerExtensions/transformationExt.html)
                                - ```javascript
// rarely working
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = 'https://cdn.jsdelivr.net/gh/apprentice3d/ForgeViewerExtensions/assets/js/extensions/transformationExplorer.js';
document.head.appendChild(script)
setTimeout(() => NOP_VIEWER.loadExtension("TransExplorerExtension"), 2000); ```
                                - 
                    - Get current Model URN
                        - ```javascript
NOP_VIEWER.getAllModels()[0].loader.svfUrn```
